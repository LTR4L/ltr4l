package org.ltr4l;

import org.junit.Assert;
import org.junit.Test;
import org.ltr4l.nn.ListNetMLP;
import org.ltr4l.nn.NNMLP;
import org.ltr4l.nn.RankNetMLP;
import org.ltr4l.nn.SortNetMLP;
import org.ltr4l.trainers.PRankTrainer;
import org.ltr4l.Ranker.RankerFactory;

import java.io.StringReader;

public class RankerTest {

  @Test
  public void rankerFactoryGetPRank() throws Exception {
    String pRankMod = "{\n" +
        "  \"config\" : {\n" +
        "    \"algorithm\" : \"PRank\",\n" +
        "    \"numIterations\" : 100,\n" +
        "    \"batchSize\" : 0,\n" +
        "    \"params\" : null,\n" +
        "    \"dataSet\" : {\n" +
        "      \"training\" : \"data/MQ2008/Fold1/train.txt\",\n" +
        "      \"validation\" : \"data/MQ2008/Fold1/vali.txt\",\n" +
        "      \"test\" : \"data/MQ2008/Fold1/test.txt\"\n" +
        "    },\n" +
        "    \"model\" : {\n" +
        "      \"format\" : \"json\",\n" +
        "      \"file\" : \"model/prank-model.json\"\n" +
        "    },\n" +
        "    \"evaluation\" : {\n" +
        "      \"evaluator\" : \"NDCG\",\n" +
        "      \"params\" : {\n" +
        "        \"k\" : 10\n" +
        "      }\n" +
        "    },\n" +
        "    \"report\" : {\n" +
        "      \"format\" : \"csv\",\n" +
        "      \"file\" : \"report/prank-report.csv\"\n" +
        "    }\n" +
        "  },\n" +
        "  \"weights\" : [ 1.0, 2.0, 3.0, 4.0, 5.0 ],\n" +
        "  \"thresholds\" : [ 15.0, 19.0 ]\n" +
        "}";

    StringReader reader = new StringReader(pRankMod);
    Ranker pRanker = RankerFactory.getFromModel("PRank", reader);
    Assert.assertTrue(pRanker instanceof PRankTrainer.PRank);
  }

  @Test
  public void rankerFactoryGetOAP() throws Exception {
    String oapMod = "{\n" +
        "  \"config\" : {\n" +
        "    \"algorithm\" : \"OAP\",\n" +
        "    \"numIterations\" : 100,\n" +
        "    \"batchSize\" : 0,\n" +
        "    \"params\" : null,\n" +
        "    \"dataSet\" : {\n" +
        "      \"training\" : \"data/MQ2008/Fold1/train.txt\",\n" +
        "      \"validation\" : \"data/MQ2008/Fold1/vali.txt\",\n" +
        "      \"test\" : \"data/MQ2008/Fold1/test.txt\"\n" +
        "    },\n" +
        "    \"model\" : {\n" +
        "      \"format\" : \"json\",\n" +
        "      \"file\" : \"model/prank-model.json\"\n" +
        "    },\n" +
        "    \"evaluation\" : {\n" +
        "      \"evaluator\" : \"NDCG\",\n" +
        "      \"params\" : {\n" +
        "        \"k\" : 10\n" +
        "      }\n" +
        "    },\n" +
        "    \"report\" : {\n" +
        "      \"format\" : \"csv\",\n" +
        "      \"file\" : \"report/prank-report.csv\"\n" +
        "    }\n" +
        "  },\n" +
        "  \"weights\" : [ 1.0, 2.0, 3.0, 4.0, 5.0 ],\n" +
        "  \"thresholds\" : [ 15.0, 19.0 ]\n" +
        "}";

    StringReader reader = new StringReader(oapMod);
    Ranker oap = RankerFactory.getFromModel("oap", reader);
    Assert.assertTrue(oap instanceof PRankTrainer.PRank);
  }

  @Test
  public void rankerFactoryGetNN() throws Exception {
    String nnMod = "{\n" +
        "  \"config\" : {\n" +
        "    \"algorithm\" : \"NNRank\",\n" +
        "    \"numIterations\" : 100,\n" +
        "    \"batchSize\" : 10,\n" +
        "    \"params\" : {\n" +
        "      \"learningRate\" : 1.0E-5,\n" +
        "      \"optimizer\" : \"adam\",\n" +
        "      \"weightInit\" : \"xavier\",\n" +
        "      \"regularization\" : {\n" +
        "        \"regularizer\" : \"L1\",\n" +
        "        \"rate\" : 0.01\n" +
        "      },\n" +
        "      \"layers\" : [ {\n" +
        "        \"activator\" : \"Sigmoid\",\n" +
        "        \"num\" : 15\n" +
        "      } ]\n" +
        "    },\n" +
        "    \"dataSet\" : {\n" +
        "      \"training\" : \"data/MQ2008/Fold1/train.txt\",\n" +
        "      \"validation\" : \"data/MQ2008/Fold1/vali.txt\",\n" +
        "      \"test\" : \"data/MQ2008/Fold1/test.txt\"\n" +
        "    },\n" +
        "    \"model\" : {\n" +
        "      \"format\" : \"json\",\n" +
        "      \"file\" : \"model/nnrank-model.json\"\n" +
        "    },\n" +
        "    \"evaluation\" : {\n" +
        "      \"evaluator\" : \"NDCG\",\n" +
        "      \"params\" : {\n" +
        "        \"k\" : 10\n" +
        "      }\n" +
        "    },\n" +
        "    \"report\" : {\n" +
        "      \"format\" : \"csv\",\n" +
        "      \"file\" : \"report/nnrank-report.csv\"\n" +
        "    }\n" +
        "  },\n" +
        "  \"weights\" : [ [ [ 0.04508320654599584, 0.02588787222014833, 0.021989130546887944, 0.02327845491472957, 0.02139911899996207, 0.025081343824252516, 0.0, 0.0, 0.0, 0.0, 0.0, 0.02498518215612628, 0.022814587001906177, 0.023595434488542736, 0.01649721592950439, 0.024046219241270466, 0.02703671674269851, 0.03068621026225612, 0.03223126447947947, 0.03337550906474054, 0.02685452350063829, 0.03055836009763554, 0.03213191080611678, 0.03215962114813318, 0.03193192985809058, 0.022097073806362236, 0.018441548961831478, 0.01643919814048188, 0.018334166289356222, 0.022981847762298162, 0.021730497456478516, 0.01907303346310705, 0.021330090598934738, 0.016775177259320855, 0.01205215651824073, 0.010000401927058025, 0.012371721035501838, 0.03218800841538917, 0.03076701868938868, 0.03290496747223468, 0.03183784895456931, 0.032487231426700354, 0.03208702922993951, 0.0, 0.021507145503409052, 0.02191790202593233, 0.027159593242885437 ], [ 0.044735513078895985, 0.026679037736515122, 0.024009376397973087, 0.026348640716151762, 0.018632169132182047, 0.02526984695734589, 0.0, 0.0, 0.0, 0.0, 0.0, 0.023979689355447403, 0.021702788482206633, 0.025911049661912135, 0.01867843840485852, 0.024427133605294676, 0.02599112018735131, 0.0, 0.029653698325563773, 0.03210489699366259, 0.027091902882465685, 0.03181932711415634, 0.035598909949096674, 0.03424533702905295, 0.03176623147650697, 0.024933121717915584, 0.022529605759850562, 0.018535463111050764, 0.02098360504594505, 0.027174711290797574, 0.021616291365271805, 0.01918907267127422, 0.02070081714537972, 0.016675067793496697, 0.012235033666610651, 0.013385554199919287, 0.012579906439497256, 0.03130928004789206, 0.03230301285091078, 0.03240600674005411, 0.031752885272362245, 0.03246344932101188, 0.02945122257672469, 0.0, 0.02169787404032932, 0.02449527941907676, 0.028744506401120976 ], [ 0.04477017875137889, 0.029329677465324597, 0.0, 0.025981304663243613, 0.019448674050805977, 0.02808998647768023, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0245272819136721, 0.02083958628968673, 0.024561234118975553, 0.01766862480775131, 0.02583932602093278, 0.025916716342794653, 0.0286850955442366, 0.03108277756372539, 0.03061501296334079, 0.02687588212708131, 0.03321927497553513, 0.03164130219353198, 0.032787616323290865, 0.03296431816752199, 0.022587641707915423, 0.021191668151715182, 0.018351586668136462, 0.022755157973355037, 0.02330171818273519, 0.021273614731856776, 0.017948769982247707, 0.0, 0.018537406344794536, 0.012979021571275985, 0.010864486766683707, 0.0, 0.03323887832045614, 0.03010502556718641, 0.032528350846126895, 0.032071337530395795, 0.033030992784300724, 0.03187554343560667, 0.0, 0.022287036714829674, 0.02257435983935609, 0.026421242316116592 ], [ 0.04483690769843751, 0.028465956271607935, 0.022147834848191467, 0.025251816074470336, 0.01854260382630733, 0.026050947002594124, 0.0, 0.0, 0.0, 0.0, 0.0, 0.02490351395215609, 0.023583445751026832, 0.02338999483852585, 0.020162313726343636, 0.0, 0.025689207882684337, 0.028795333755412815, 0.0, 0.032339145223151324, 0.0, 0.03107185593997003, 0.03363297738235031, 0.032093134503259964, 0.03379827798652577, 0.02478807062968185, 0.022604345040105785, 0.021313689775284018, 0.020695951400295662, 0.02326740913979713, 0.02358747741213576, 0.020576448656774892, 0.020737189286799535, 0.0, 0.015718936432335514, 0.012005080171818387, 0.012381023758741207, 0.03168158429740357, 0.03296813612325826, 0.03336297437929489, 0.0342405332826458, 0.03419599765180712, 0.0314693951136693, 0.0, 0.0240498735388374, 0.023712300439314025, 0.027045403476155326 ], [ 0.044935984702051915, 0.02792568242237338, 0.021894499841129466, 0.02441263802728894, 0.021385036492672867, 0.02508520535935011, 0.0, 0.0, 0.0, 0.0, 0.0, 0.025672185237444807, 0.023262472221533582, 0.024476553422529856, 0.018143082817735422, 0.026691323554876648, 0.025659458560204, 0.03238646056764795, 0.03321587215830962, 0.030225195744868, 0.02779269723809193, 0.033980430305728344, 0.0335243846203888, 0.032545076843372586, 0.03279783112914882, 0.02644147253286899, 0.020188903614274143, 0.020289589007035494, 0.019449186106515103, 0.024817854946427974, 0.025461498119238413, 0.01989342877517725, 0.021120735420658395, 0.01907272201268952, 0.015296371224107637, 0.010691961032290387, 0.013341660828469156, 0.030624196293916883, 0.034330943021807954, 0.03471579536442573, 0.034104234751341486, 0.03536381518076666, 0.03393190774658292, 0.0, 0.02108040944940392, 0.023356828585021645, 0.02866957978590501 ], [ 0.04540418864121852, 0.02745948252974064, 0.02545086767149334, 0.024821911505425797, 0.019516654628312882, 0.026473325201673763, 0.0, 0.0, 0.0, 0.0, 0.0, 0.026701571550863522, 0.02334635714194562, 0.0, 0.018282303253116992, 0.026086066536776552, 0.02878493393064701, 0.03146734748287627, 0.0320041154100825, 0.03130896021050496, 0.02621269109378344, 0.031808044232657394, 0.03297636506276275, 0.033132325090535146, 0.029765989561084737, 0.024284186312078477, 0.02236809811838828, 0.0219855050807655, 0.021287038526631177, 0.02533325051033473, 0.02255901513127219, 0.023152895358823013, 0.022492231433821428, 0.01978339601755908, 0.012798208780916578, 0.011307267248609185, 0.013531299886767302, 0.03489421946421507, 0.03263804544970231, 0.035976525349628384, 0.033567579633702944, 0.03390467521863056, 0.0328368125088814, 0.0, 0.022445653268297592, 0.02357666845448805, 0.028220020396052703 ], [ 0.04230540363336604, 0.024505793844456256, 0.019318712329312007, 0.02186708953418789, 0.016183103938153403, 0.023338879366288492, 0.0, 0.0, 0.0, 0.0, 0.0, 0.022969292362371562, 0.017201900197330606, 0.019563309453546958, 0.015297055286685556, 0.024188770555164926, 0.026874616732715607, 0.026553167241533535, 0.029438384815306997, 0.02835227057707165, 0.0, 0.02868778611331224, 0.02950895635585882, 0.02883135698708793, 0.030975443689245236, 0.0, 0.01762173502269486, 0.015465305011748596, 0.016916959220200506, 0.022073539001863096, 0.01752654324302039, 0.016846053385797324, 0.0, 0.015470952694570246, 0.010923802339046338, 0.007727930104050831, 0.010056193469677474, 0.027815687644911016, 0.030051127070078124, 0.030040623387192572, 0.029750292277696388, 0.03030126092504362, 0.0, 0.0, 0.02026534533959504, 0.021218607176570405, 0.0264312944141837 ], [ 0.04443883600595573, 0.025650487653863307, 0.02382214922107754, 0.022712603453636005, 0.016715351471252127, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.024009812406831563, 0.019192254721604286, 0.021744778178979823, 0.016769090416759044, 0.023964877848416347, 0.0, 0.029205641993862767, 0.03144311636725336, 0.030507726340510067, 0.0256480951456683, 0.03120070794758737, 0.0, 0.03317195575595496, 0.0, 0.023321183831220393, 0.019631528598476205, 0.0, 0.01723791273475698, 0.023633762966873903, 0.0, 0.0, 0.01640298146843087, 0.0, 0.0, 0.009467810453864248, 0.011792158106821972, 0.03127813834696251, 0.02987540511881298, 0.03156059096044293, 0.033327482277966725, 0.032740626147669025, 0.0, 0.0, 0.0, 0.02228809410234935, 0.026832468364657965 ], [ 0.044260412633604425, 0.0243722484821958, 0.020898089203911004, 0.023877829979835553, 0.0, 0.0260740320471398, 0.0, 0.0, 0.0, 0.0, 0.0, 0.02445450448342402, 0.02388918785386246, 0.02278090065097489, 0.016381105386864544, 0.0, 0.0256980387742064, 0.030615818662906327, 0.032650288297480914, 0.030279852103698327, 0.0, 0.033882183812714774, 0.034242565389700386, 0.03424365112106861, 0.032242353403181684, 0.022533640418677215, 0.02096589060387203, 0.017630713024284095, 0.01876793980940191, 0.024087705262610264, 0.0, 0.018189374785917048, 0.019255469699604538, 0.01692003890098878, 0.012852507908118918, 0.009454253407516391, 0.0, 0.03246708333921994, 0.033880416955663885, 0.033001522418694924, 0.032764233529414696, 0.03189873135625195, 0.03132347765315024, 0.0, 0.02079800017398645, 0.02226498710762746, 0.025894646988095602 ], [ 0.044009118735480975, 0.025071892791059824, 0.01842757909791817, 0.021904893568620312, 0.016874475498662556, 0.025618155728618523, 0.0, -7.743151093276623E-4, 0.0, 0.0, 0.0, 0.026029143742296534, 0.0, 0.022331491524715905, 0.01681208107269504, 0.0, 0.0, 0.030072293147533763, 0.0316012038897703, 0.03102043690762683, 0.025595028890705314, 0.030257414814297397, 0.0320768459755858, 0.03082048463173439, 0.031192055414730583, 0.022569939090614236, 0.02006590004637143, 0.02061201464911992, 0.017261579644196286, 0.02416998988295214, 0.01986951763899546, 0.018967863400754337, 0.01928619468095915, 0.020707952688286554, 0.013287737783504883, 0.010381106655208534, 0.0, 0.02983220477923327, 0.0295277821717765, 0.029938690999797034, 0.03091115370381363, 0.0, 0.03383360553445234, 0.0, 0.0, 0.023575184005300145, 0.027965014064053682 ], [ 0.04534586347452614, 0.026535661619090874, 0.022119485580059182, 0.025561216520339745, 0.019256909727917708, 0.02663608944528018, 0.0, 0.0, 0.0, 0.0, 0.0, 0.026111772281478655, 0.024430771001562834, 0.025484865379986284, 0.01914728252883906, 0.026031226708092176, 0.02796021291186372, 0.030916689852828392, 0.032379075522186135, 0.0, 0.026333695179104045, 0.03126951032596264, 0.033369914538581506, 0.033645200195796615, 0.03326147145477576, 0.024366515843149368, 0.020796114175313542, 0.019467939707253835, 0.019315267908983417, 0.024423062100671734, 0.021367992476173173, 0.020350264405395006, 0.021289672787836476, 0.017512064841023006, 0.013108272307275787, 0.0, 0.012710247092178224, 0.03224618761163892, 0.032184740803435606, 0.03235047140747582, 0.033478561662260105, 0.03274958224113836, 0.03285317301227712, 0.0, 0.028036207471141522, 0.020858727821815706, 0.027006052234131512 ], [ 0.04241094323176299, 0.0228044089656283, 0.018177620801445114, 0.0, 0.0, 0.023102986290132164, 0.0, 0.0, 0.0, 0.0, 0.0, 0.025553782607341133, 0.017135954359556414, 0.02116750590589673, 0.0, 0.0, 0.0, 0.0, 0.02863751028515113, 0.0, 0.0, 0.028501573465857716, 0.02970129676541834, 0.0, 0.02979537116007764, 0.019390218500185318, 0.016411514269175437, 0.0, 0.014352358094179191, 0.0, 0.018001434523492864, 0.01560836934594791, 0.016073779786446318, 0.0, 0.009695514250218447, 0.010531027689780757, 0.0, 0.028655344730732873, 0.029012331506593984, 0.02819901934838432, 0.029121942365987682, 0.029606539775686593, 0.029304264234042747, 0.0, 0.020115951427274126, 0.0, 0.0 ], [ 0.03890713445875018, 0.018357191172880954, 0.005956866190153245, 0.010137205387494866, 0.008674508238964006, 0.018248968333016206, 0.0, 0.0, 0.0, 0.0, 0.0, 0.017859157949740984, 0.006955027559717652, 0.00925037535107237, 0.007974278362364392, 0.01800716897716403, 0.019822291658605554, 0.019313457467982, 0.024805684783539103, 0.0, 0.019918784193459292, 0.02188428520145233, 0.0202332294145618, 0.0, 0.0204867716536047, 0.006762740806894116, 0.00596010452654845, 0.004701939985461339, 0.003885587078059762, 0.008631202026335652, 0.0, 0.003858468625222912, 0.003092323411750561, 0.007797479012841292, 0.006712078883839826, 0.005469526971463843, 0.005217611798990553, 0.01953971464480458, 0.020177084230889156, 0.020964725772385506, 0.021452695021305753, 0.027608460718901814, 0.02569789745782214, 0.0, 0.0, 0.0, 0.0 ], [ 0.04300081541432175, 0.023181504195514346, 0.018894245251558587, 0.02160856920976359, 0.01859136177262155, 0.024242616129665648, 0.0, 0.0, 0.0, 0.0, 0.0, 0.02361342034580217, 0.0, 0.021743465550568483, 0.016650256762119866, 0.024107543358849293, 0.0, 0.027676863385220733, 0.0, 0.030115228656521314, 0.026155233551326772, 0.030441524440935102, 0.02822040965347692, 0.030223887680079817, 0.029189854335889227, 0.01962221475484295, 0.018384136659081268, 0.014227301490160315, 0.0, 0.023319140210283158, 0.018890925928352096, 0.0, 0.0, 0.0, 0.009828763260304527, 0.008868108943520785, 0.011300600037926756, 0.03025605227549639, 0.03038205753687184, 0.0, 0.030830951120017363, 0.034200402263415676, 0.03008609706184348, 1.6981754238819426E-4, 0.019073081908526923, 0.020682284880217387, 0.0 ], [ 0.04470064482723922, 0.025640739969729896, 0.022387963198862732, 0.0, 0.019837400934619526, 0.02706458465004105, 0.0, 0.0, 0.0, 0.0, 0.0, 0.024312036344368536, 0.020952066539738693, 0.02525801681861796, 0.016871739329106464, 0.0255833199232855, 0.028619176515226868, 0.02857606002296966, 0.0315416275263945, 0.03243979912567375, 0.028607064245279555, 0.03198648023440971, 0.03417481106842613, 0.03309644836521574, 0.033473077436669635, 0.02606550148443095, 0.020307005022131147, 0.020155412282752572, 0.0, 0.02306176657165543, 0.02301406183369158, 0.020577756992058025, 0.021178403797860804, 0.01678078525903185, 0.014062879946081144, 0.01092699477066352, 0.012644937859915594, 0.032332025265414795, 0.03145791689261873, 0.03310510153458255, 0.03157605844299981, 0.03451641522140973, 0.03038732085206949, 7.68104761024472E-4, 0.02035021839606644, 0.023885832103771317, 0.028594628126576992 ] ], [ [ 0.043153447436959404, 0.03263388211889602, 0.03624002844106006, 0.03379629676187908, 0.032875175013758744, 0.03341285158446414, 0.03467748020610859, 0.031383600332728356, 0.03239443575404363, 0.034246706259523585, 0.03271974481316856, 0.03318236509442711, 0.03153790170220098, 0.0, 0.03184359721306277, 0.03509456199490467 ], [ 0.0020520561332032583, 0.0, 0.0, -5.024184514661798E-4, 0.0, 0.0, 0.0, 0.0, -5.816869338822436E-4, -5.042676834686971E-4, -2.897951400085984E-4, 0.0, -0.0016377615796945978, 0.0, -2.103620579156263E-4, 0.0 ], [ -0.020519878680602337, -0.028985170232543152, -0.028774805641027367, -0.027671140241358076, -0.027637695707938423, -0.027191508796764245, -0.028681261904986773, -0.02792344040168397, -0.029191148578373564, -0.029729044333679722, -0.02738607654517577, -0.02942532121247833, -0.02823584444743209, -0.02786294566212963, -0.027915281282894857, -0.028779776118453407 ] ] ]\n" +
        "}";

    StringReader reader = new StringReader(nnMod);
    Ranker nn = RankerFactory.getFromModel("nnrank", reader);
    Assert.assertTrue(nn instanceof NNMLP);
  }

  @Test
  public void rankerFactoryGetRankNet() throws Exception {
    String ranknetMod = "{\n" +
        "  \"config\" : {\n" +
        "    \"algorithm\" : \"RankNet\",\n" +
        "    \"numIterations\" : 100,\n" +
        "    \"batchSize\" : 10,\n" +
        "    \"params\" : {\n" +
        "      \"learningRate\" : 1.0E-5,\n" +
        "      \"optimizer\" : \"adam\",\n" +
        "      \"weightInit\" : \"xavier\",\n" +
        "      \"regularization\" : {\n" +
        "        \"regularizer\" : \"L2\",\n" +
        "        \"rate\" : 0.01\n" +
        "      },\n" +
        "      \"layers\" : [ {\n" +
        "        \"activator\" : \"Sigmoid\",\n" +
        "        \"num\" : 10\n" +
        "      } ]\n" +
        "    },\n" +
        "    \"dataSet\" : {\n" +
        "      \"training\" : \"data/MQ2008/Fold1/train.txt\",\n" +
        "      \"validation\" : \"data/MQ2008/Fold1/vali.txt\",\n" +
        "      \"test\" : \"data/MQ2008/Fold1/test.txt\"\n" +
        "    },\n" +
        "    \"model\" : {\n" +
        "      \"format\" : \"json\",\n" +
        "      \"file\" : \"model/ranknet-model.json\"\n" +
        "    },\n" +
        "    \"evaluation\" : {\n" +
        "      \"evaluator\" : \"map\",\n" +
        "      \"params\" : {\n" +
        "        \"k\" : 10\n" +
        "      }\n" +
        "    },\n" +
        "    \"report\" : {\n" +
        "      \"format\" : \"csv\",\n" +
        "      \"file\" : \"report/ranknet-report.csv\"\n" +
        "    }\n" +
        "  },\n" +
        "  \"weights\" : [ [ [ 0.0017051564993876703, 0.005077349746418424, 0.009556125980402001, 0.005568526722242471, -3.823846547286138E-4, 0.003735094212986644, 1.2830568958067425E-4, 1.924652796814746E-4, -0.002479031277674815, -0.0017637528290790185, 0.0013858797149532268, 0.008737268113563092, 0.0040891104187811955, -2.1319334612927233E-4, -5.747739398054958E-4, 0.007039210125212763, 0.0010536875409865195, 0.00713049398530738, -0.005748873603449065, -0.004319715159560238, 0.0026005087459226484, 0.008315584649381176, 0.004681587469775332, 0.012301035206686605, 0.0093931280342585, 0.002345442931286881, 0.007815590472009715, 0.0057504147570240065, 0.005198789787515675, 0.006921859283796152, 0.008466922742482334, 0.00530207638978974, 0.006932437267894725, 0.0042297390622818174, 0.002142357136119394, 0.0011379683166344075, 6.450525629260708E-5, 0.0063695882587756145, 0.005273672213046188, 0.006810740451203809, 0.006636920882514934, -0.0045798897570925885, -0.0037600402470963756, -0.002431704528794047, 0.0012386255540568893, 0.0015913956884872089, 0.003189146906197261 ], [ 0.002131479696459774, 5.159659583839533E-4, 0.002504130584728356, 0.004999014291768024, 0.001284210096412231, 0.008274305124289328, -1.9252139143283186E-4, 0.0024515175995304707, -2.645707486395114E-4, -7.175726424897286E-4, 0.002853538898904533, 0.004827559402036743, 0.004532593003270562, 0.005165075898630313, 6.393242228252363E-4, 0.0047709637332051195, 3.2634789118341395E-4, 0.002255095677255101, -0.0011757911442746157, -0.003012976150245363, 6.166786501125468E-4, 0.006088140677288533, 0.007816266331330684, 0.0017736368151116872, 0.0031543346758175416, 0.0030537617883403716, 0.007134108787749181, 0.005791014942099432, 0.006441519412356422, 0.004931157860016768, 0.00557428553240514, 0.004411051230255179, 0.006338459172064221, 0.0040782131725515675, -0.002163722752340391, 7.183630530516713E-4, 0.0014809170361981257, 0.004980078810022915, 0.00615668551894385, 0.00527479282504721, 0.004170119849795665, -0.00306281087033514, -0.008639140900396467, -0.0021043519471863757, 9.208611826178332E-4, -3.2470594671247296E-4, -8.723484460143315E-4 ], [ 0.0178508983324466, -0.004985267938721381, -0.006316496176449784, -0.0035416750477454554, 4.744946143055102E-4, -0.002826437205332762, 0.0026134307716565606, -0.0018172935004898915, -0.0010335670826696146, -1.2590397471573582E-4, -2.3069402114494263E-4, -0.005302173367298667, -0.008368334000664593, -0.0038108457114512037, -7.549772354841165E-4, -0.008063957313542614, -0.005036648287273536, 0.001262684259238434, 7.362756955919028E-4, 0.004455591625486754, -0.0018436268660716993, -0.00524299607352548, -0.009785349115689889, -0.009269793466621396, -0.008584529371984546, -0.002853308515458032, -0.004243006241948313, -0.009287920062716172, -0.007710760711064452, -0.005958863493530608, -0.008248222578216172, -0.0077028423993574175, -0.0024894258163359433, -0.0028100452492280078, 7.434195854633017E-4, -5.299231462896684E-5, -0.00540818071995609, -0.006718075801578333, -0.0049486885312504305, -0.008734281574424952, -0.005211261876521546, 0.0024140845947399807, 0.004832843300177744, -0.0019484623547831221, 1.596384820248689E-4, -0.001932240332987687, -3.8088281567863773E-4 ], [ 0.017418183692592654, -0.005946768047638425, -0.004578100356146686, -0.005128575735005222, 1.3293357463296484E-4, -0.0027872176028214328, -0.004206130777557281, -0.0013834327862863526, 0.002665457066189151, -0.005628832136139795, 0.0025816725017632223, -0.0023570432122099073, -0.009317720799579064, -0.005850178849824196, -0.004037600746305489, -0.0030050558120644035, 3.9375739834204116E-4, -0.0014488138880481654, -2.510374850061227E-4, 0.001021596265452969, -0.005436477461995628, -0.002526242729558914, -0.0068740078667163425, -0.008691463835010044, -0.0014131962216934464, -0.003321368007091281, -0.006608880849497217, -0.006731214355190261, -0.003619089604627263, -0.008653874728359734, -0.006043986075597068, -0.009200798537100914, -0.0049689918527073785, -0.0017428947117555066, -5.393533406570749E-4, -0.002033456550787019, -0.003146162250468424, -0.0062553573437789094, -0.006914519959113239, -0.006759138076210685, -0.00858168417685398, -3.39338416911908E-4, 0.004744649871120316, -0.0034378099276557595, 0.0022824046921125283, -0.0020946771671930355, -0.0015775714719383864 ], [ 0.0021672794483045244, 0.005949617979880958, 0.004614237186703073, 0.004115003866311874, -4.665002664329822E-4, 0.0037749486410136464, 1.881524176096905E-5, -0.004072933342786099, -0.005257634901199188, -2.074748753840381E-4, 0.00409413769883369, 0.005615366787790909, 0.0067573558117759325, 0.002153902876393426, 0.0016309150993774073, -1.4908684800235138E-4, 0.003390327582344153, 0.0029128277910011346, 5.621877305838799E-4, 7.183825344066701E-4, -3.5386342885606676E-4, 0.0037745639204830473, 0.0036423288159906776, 0.006837231412507055, 0.006872795588462262, 0.0066681071689920325, 4.43007554374634E-4, 0.006343035170498919, 0.00547658144729556, 0.005489814141990868, 0.008888990242333415, 0.0035313149761706315, 0.002584733238715298, 3.329249076977092E-5, 0.003868797421377967, -0.0011053187022182112, 4.4241726367439803E-4, 0.0026630774982368734, 0.008068667691714965, 0.0029107792798040207, 0.0033819992194969828, -0.004207728988428261, -0.0023490872933131035, -5.7896157887898464E-5, -0.0019446543524686594, -0.003674212268036334, -0.002385626866663141 ], [ 0.0019909816849409926, 0.008041133179566135, 0.00827929719187856, 0.005397295296717025, 0.0012297373164240793, 0.004362286090825735, -6.689373420192875E-4, -5.656147596558872E-4, -0.0019052276809492143, -0.003514201834327744, 0.0023286492552704067, 0.0036212867777316925, 0.005862209866101512, 0.0028661416831616045, 5.027070389836566E-5, 0.004810411395240348, 0.002620943093495829, 0.007327994051260392, 3.004016258921324E-4, -0.0022940316935095902, 0.0017272909555489037, 0.00292583566939695, 0.0039638467367282505, 0.003442515094054837, 0.0060112586709027685, 0.005579937347349339, 0.003656838431651704, 0.005972642071627484, 0.005416883295916015, 0.0022316468227381266, 0.0075556083952833045, 0.008616902501961255, 0.004602406258461114, 0.004826845181013182, 6.599926090291837E-4, 0.0011888385890953697, 0.004183521653727613, 0.006034193568105182, 0.00452843657629155, 0.006901608712268441, 0.0055261017128156965, -0.0025682707944304963, -0.005517861348421538, 0.0013459369634786075, -0.0026040041019491545, 0.002254080519148041, 0.0031778631027699006 ], [ 0.016438950887213657, -0.004534629050977526, -0.007962139831590328, -0.004780854894628165, 9.356445131698427E-4, -0.0020035220862091373, -0.0017223125850707288, -0.002786107197496895, 0.001109000356629293, 0.001414702475023043, 0.0012066087940734494, -0.003622470048429344, -0.005976567827510579, -0.0017990849710311921, -0.005461829213226115, -0.007181643681250523, -0.0050078322939386575, -0.0015982960886475135, 0.0010120045040066074, 0.0051961835102786, -0.0028143148766022292, -0.004387142652449271, -0.008317272787728364, -0.008218650858527897, -0.00414738353487463, -0.0036381278298135834, -0.005528243312608184, -0.0032755947097848938, -0.0035889424822062774, -0.0020141880584264834, -0.006441654778586783, -0.006422133829051303, -0.0055267686869673455, -0.004958322523983321, -0.0019212604793059076, -0.0038873894898231354, -0.002465009189834518, -0.0038625405119730553, -0.009603356919833638, -0.002052981852469597, -0.009520095881202091, 0.003347029958040544, 0.004892606505495941, -0.0023800106686850593, 0.0013762799436016849, -0.0017882576669485347, 6.927165071784724E-4 ], [ 0.003176672208848094, -0.0014689068556980106, 0.008042500699668595, 0.003552490119528055, -6.451794889393587E-5, 0.0057180565540825845, 9.690366026325326E-4, -0.0030860963468919275, -5.372756621740678E-4, -0.001963701892734653, 0.0012686436699472718, 0.004143467920291434, 0.003465202378974967, 0.007494811433211707, -0.0010262839742963999, 0.001942908024482122, 0.0011614519050925551, -4.018013197829175E-4, -8.048911418713115E-4, -0.006136861482732469, -0.0016591905298625653, 0.0031857960811009583, 0.005002051680306815, 0.0038861535772934473, 0.0038457397486576336, 0.002595547116033356, 0.002830334221091625, 0.004435950025048765, 0.007173685916859338, 0.004451241062119873, 0.004490177443188681, 0.001865733555238102, 0.0032421659037307833, 0.0014121416467639371, 0.0016442916776301772, 0.005507927778534628, -0.0011086139898072494, 0.005237812128394495, 0.004910960572561403, 0.006306121975856214, 0.003848372075655517, 0.0017896745295520409, -0.003671620824127521, 1.9461867041780813E-4, 9.386687174481055E-5, 4.448716157229439E-4, 0.00254234754021465 ], [ 0.0020602135994464937, 0.0034712492576709658, 0.002369745480351675, 5.691045130857777E-4, -3.892167044727705E-4, -0.0014368887456859094, 0.0019898209627139665, -0.0015740274332454176, 2.1746355556748092E-4, 5.207723230500644E-4, -0.004004387092355937, 0.006045779822451946, 0.005952503092071983, 0.007626309103139834, 0.0029999480190259662, 0.004874448707717879, 0.003075114104557776, 7.607551305213158E-4, 0.0011120711504843761, -0.0029838340736187746, -5.224290497309299E-4, 0.006946865604612072, 0.00503990102683632, 0.006779612476912917, 0.004681012884882604, 0.004818413801236336, 0.0017698201875391258, 0.007170502125934934, 0.003022329145720638, 0.0020039077634755203, 0.0040326242270665065, 0.00563555734293833, 0.004411595667735946, -3.857186587996728E-4, 0.005203285141245352, 0.0020129502856363365, -2.4335852738854846E-4, 0.005701832882778617, 0.008644264810151623, 0.0032799172560975306, 0.005535543308505117, -4.224409189095845E-4, -0.005051171452006555, -0.0010042010500846664, 0.003737384124044793, -0.0031039776394022243, 0.0018003361826874076 ], [ 0.01505129347675908, -0.003217148534351828, -0.004370435256946914, -0.004226048187991732, 0.0017597027727538647, -0.0016845266966419763, 6.822523336855325E-4, 0.0012946306563368592, -5.859025319954584E-4, 0.0033104052908508293, -0.0026229457846012588, -0.006428838271409849, -0.007104899814133689, -0.005133434335391949, -0.005879455552839476, -0.0030871812587252552, -0.0032505155777654586, -0.0019540968207780664, -9.87128611305763E-4, 0.008013125322468598, -2.14914447333186E-4, -0.005399895900780274, -0.008879884410600261, -0.005344548271872153, -0.001775083511354007, -0.004372179837567172, -0.003911730617078261, -0.004666801111239196, -0.005147150553995877, -0.006235335897858132, -0.0077653149192036496, -0.00654698525366253, -0.0067166102797856665, -0.0025457422445470815, -0.002810517416077599, 6.489123159131628E-4, -0.001107843994428336, -0.004197309044656741, -0.0010187002324224305, -0.008220588614236097, -0.006570258087374898, 0.005986748947094912, 0.004717987808506469, 0.001252636638061352, 5.76488026949397E-5, -0.001056234547784597, -0.0013739029981222714 ] ], [ [ 0.009999335022077518, 0.006068825320330716, 0.008357393487310386, -0.006271892234118932, -0.006920155015892252, 0.01098775817094946, 0.008029880550726244, -0.006809945249608074, 0.007060799038963369, 0.009033355845928246, -0.007441520835924173 ] ] ]\n" +
        "}";

    StringReader reader = new StringReader(ranknetMod);
    Ranker ranknet = RankerFactory.getFromModel("ranknet", reader);
    Assert.assertTrue(ranknet instanceof RankNetMLP);
  }

  @Test
  public void rankerFactoryGetFRank() throws Exception {
    String frankMod = "{\n" +
        "  \"config\" : {\n" +
        "    \"algorithm\" : \"FRankNet\",\n" +
        "    \"numIterations\" : 100,\n" +
        "    \"batchSize\" : 0,\n" +
        "    \"params\" : {\n" +
        "      \"learningRate\" : 0.001,\n" +
        "      \"optimizer\" : \"momentum\",\n" +
        "      \"weightInit\" : \"normal\",\n" +
        "      \"regularization\" : {\n" +
        "        \"regularizer\" : \"L2\",\n" +
        "        \"rate\" : 0.01\n" +
        "      },\n" +
        "      \"layers\" : [ {\n" +
        "        \"activator\" : \"Sigmoid\",\n" +
        "        \"num\" : 5\n" +
        "      } ]\n" +
        "    },\n" +
        "    \"dataSet\" : {\n" +
        "      \"training\" : \"data/MQ2008/Fold1/train.txt\",\n" +
        "      \"validation\" : \"data/MQ2008/Fold1/vali.txt\",\n" +
        "      \"test\" : \"data/MQ2008/Fold1/test.txt\"\n" +
        "    },\n" +
        "    \"model\" : {\n" +
        "      \"format\" : \"json\",\n" +
        "      \"file\" : \"model/franknet-model.json\"\n" +
        "    },\n" +
        "    \"evaluation\" : {\n" +
        "      \"evaluator\" : \"NDCG\",\n" +
        "      \"params\" : {\n" +
        "        \"k\" : 10\n" +
        "      }\n" +
        "    },\n" +
        "    \"report\" : {\n" +
        "      \"format\" : \"csv\",\n" +
        "      \"file\" : \"report/franknet-report.csv\"\n" +
        "    }\n" +
        "  },\n" +
        "  \"weights\" : [ [ [ 65.49851665035762, 30.63694336976621, 6.7446361630253335, -3.351566550553486, 3.757354375316103, 28.513972854715803, -0.26986468164046007, -2.0056994124255243, -0.6172352667808356, -0.043161691300306504, 1.4084748685050434, 15.292738286249916, 5.936339134712766, -2.243926783673626, 5.013430632266347, 14.03770179114526, 33.05513905210285, 17.43107540624184, 24.82983130344315, 11.886799377693132, 33.176372703454476, 33.33235203094352, 32.78700967804286, 42.9609614546719, 35.35825882787819, 4.361578163348861, 3.5098379719029085, 4.599463154834145, 3.85472004625112, -3.543516748095087, -2.5267507909387477, -0.5422777685871495, -2.4749213980981937, 4.549611028255907, 4.795196221891452, 6.578634083194513, 1.620716099301436, 32.57005719252751, 32.46496858369146, 43.03228080860314, 33.827833782111796, 31.571999151539835, 11.210813462652698, 0.36293857622493236, 4.964796207205503, 5.934806916607523, 8.28330959277649 ], [ 52.01058006829889, 6.90784169192113, 0.6747547545415093, -2.303017815463181, 1.1738465332035257, 8.046958411747164, 1.3383819091182145, -0.1672188893543127, 0.5852921770682605, -1.6607180479292138, 0.5053930373579677, 13.075951497439174, 1.099173114049158, -3.478454286473249, -1.5638097225299572, 13.770089539523662, 11.507766479306017, 7.644033291361855, 13.520354396335081, 13.955220466386066, 9.46235577202805, 3.1483474990328815, 3.6109881181158596, 3.8922251028705244, 5.317334976159016, 1.552394588242593, -1.0457668214029325, 0.32884770115441836, -1.5251095947929543, -1.3740963811407085, -2.8295404151770045, -4.521064623826606, -3.106641211447988, -2.299892162473028, -2.5226232604945986, -5.28398400040366, -4.742187128186116, 5.413401865280924, 3.5914552883497417, 3.1368205337220196, 5.567619746797801, 20.625291085923013, 12.813073953866635, -0.2887078067833971, 2.891307578182754, 3.7640677453706743, 7.428190124967821 ], [ 90.11213654347645, 34.00904393511939, 22.836707975739696, 27.968458862017307, 12.307237388902799, 34.61669541790871, -1.3400377227039988, -0.04005930241502073, 0.6916941140589028, 0.2205207214883022, 0.9588831611660061, 36.564504198120176, 21.64941835563442, 26.345449376378788, 12.242749533670448, 36.45783898224135, 30.432767680832104, 19.241886942133412, 26.09568046420788, 14.31537142357773, 31.653004255579553, 69.2846777923194, 66.38658413713746, 77.3124447153188, 66.51231717510277, 28.688034772175296, 31.983565776417308, 28.15213320741465, 30.508690788658114, 23.174896527053328, 25.439901588118577, 29.08404015217538, 25.71831168166983, 12.911510421971618, 11.759785436093361, 14.210014206506951, 13.203120247247641, 69.52487776690467, 68.34508579206539, 77.50127164153568, 70.8003139674006, 32.76872379149567, 16.8693756520882, 1.4136291922155753, 7.342746671190429, 7.413633013714078, 11.097020085500402 ], [ -74.79116866853522, 0.08061758714871842, -3.821779330870996, -3.2161699293371244, -8.170977050983499, -1.102795016345459, 0.8663913430630769, -0.3325086783511289, -1.0829461450006392, -1.4760094552737064, -0.7193501993193494, -16.087156217311918, -3.3656618325260683, -3.17056600154114, -3.876524968541843, -15.362128393943003, -0.8860715304367198, -10.143852850072859, -18.03547243019156, -22.23273915409068, -1.0257996768432842, -16.807787135531093, -18.505543170905888, -11.406237079895218, -16.137899938901594, -3.5885844135180465, -4.915057082247281, -1.2831801988159437, -2.969029601535679, -7.280892551473125, -2.5815873984109956, -1.919849864325297, -1.2571982716371872, -5.251923006568379, -3.53023129472564, -3.3415617810452094, -2.2921872211403196, -14.93218411048919, -16.465793502304024, -9.424704033577973, -17.871511186300115, -30.66848730397952, -24.64744161759858, 0.4902612536995693, -4.036183393043125, -6.523382684722097, -8.599032228421299 ], [ -55.511037947542704, -46.77815541632454, -9.766390674148338, 9.276335375058077, 9.386638518119458, -47.12138033609534, -1.0600472745076575, -0.9059579023815839, -0.53018416603032, 0.32918818366249597, -1.5557914398597306, -17.373827009266908, -7.188989786601775, 10.852618082600413, 8.441976737361685, -20.008280927738642, -48.48764774075882, -18.144540116600858, 10.056608861903117, 9.430317446549255, -49.311187654125625, -33.80578023426826, -32.203208820565585, -58.54156726930967, -37.76840548160935, -1.2886915461136053, 1.0098810300512113, -5.237688910008102, -2.853741831856227, 16.79785313658843, 11.6575692414186, 7.33554486639026, 6.932145302017606, 3.8854264043942743, 4.298272577486638, -0.4487758491127385, 1.7514821387564257, -33.59199873140387, -35.461239400819025, -56.713782332219964, -38.39190319481994, -10.060579254461334, 3.268960054868048, 0.19791700295304973, -7.222820727102024, -7.754247854666673, 5.7470025327220435 ] ], [ [ 0.009990004948299712, 5.605358226801693, 43.34320640058383, -15.628750831138838, 65.52363327580116, -50.94222163466931 ] ] ]\n" +
        "}";

    StringReader reader = new StringReader(frankMod);
    Ranker franknet = RankerFactory.getFromModel("franknet", reader);
    Assert.assertTrue(franknet instanceof RankNetMLP);
  }

  @Test
  public void rankerFactoryGetLambdaRank() throws Exception {
    String lambdaRankMod = "{\n" +
        "  \"config\" : {\n" +
        "    \"algorithm\" : \"LambdaRank\",\n" +
        "    \"numIterations\" : 100,\n" +
        "    \"batchSize\" : 0,\n" +
        "    \"params\" : {\n" +
        "      \"learningRate\" : 0.001,\n" +
        "      \"optimizer\" : \"adam\",\n" +
        "      \"weightInit\" : \"xavier\",\n" +
        "      \"regularization\" : {\n" +
        "        \"regularizer\" : \"L2\",\n" +
        "        \"rate\" : 0.01\n" +
        "      },\n" +
        "      \"layers\" : [ {\n" +
        "        \"activator\" : \"Sigmoid\",\n" +
        "        \"num\" : 10\n" +
        "      } ]\n" +
        "    },\n" +
        "    \"dataSet\" : {\n" +
        "      \"training\" : \"data/MQ2008/Fold1/train.txt\",\n" +
        "      \"validation\" : \"data/MQ2008/Fold1/vali.txt\",\n" +
        "      \"test\" : \"data/MQ2008/Fold1/test.txt\"\n" +
        "    },\n" +
        "    \"model\" : {\n" +
        "      \"format\" : \"json\",\n" +
        "      \"file\" : \"model/lambdarank-model.json\"\n" +
        "    },\n" +
        "    \"evaluation\" : {\n" +
        "      \"evaluator\" : \"NDCG\",\n" +
        "      \"params\" : {\n" +
        "        \"k\" : 10\n" +
        "      }\n" +
        "    },\n" +
        "    \"report\" : {\n" +
        "      \"format\" : \"csv\",\n" +
        "      \"file\" : \"report/lambdarank-report.csv\"\n" +
        "    }\n" +
        "  },\n" +
        "  \"weights\" : [ [ [ -0.13736076280191786, 0.11831000126045484, 0.11912441202451216, 0.12440511336262026, 0.10305602452306571, 0.11702990339383623, -3.939966583453593E-4, -0.0038433378152972967, -9.105577783503584E-4, 2.16995342302539E-4, 8.221375372871246E-4, 0.10121671858934271, 0.11791985874083742, 0.12144917601150737, 0.10754977520946361, 0.09615573432763685, 0.10610126510109587, 0.06436178101440863, -0.06327520285334434, -0.14126392840481855, 0.10817827772749708, 0.11793674571819997, 0.11821514192906847, 0.12329271334383397, 0.1177217223842382, 0.11591439209470814, 0.1193035119839636, 0.11940763472355687, 0.11737426904598647, 0.12005703261428133, 0.11992016862981524, 0.1246358695293424, 0.12149206399778284, 0.11483583328057792, 0.11263469221211345, 0.11435792318932518, 0.11180739235361345, 0.11922851925103818, 0.11621146977141138, 0.12104101876303494, 0.11942609152859182, -0.13956431472316375, -0.13866110455842537, -0.002184272665517555, 0.05453400947664844, 0.042245517364249356, -0.07857069289482757 ], [ -0.1373194179077316, 0.11844060127737263, 0.12395898072836149, 0.12573344216421897, 0.10689452497761749, 0.12283283187869326, 0.002095788145192931, 1.877197032211827E-4, -0.0015368165254798316, -4.545066561902619E-4, 0.0014317875295862858, 0.09519325625527675, 0.1218817564623761, 0.12410396210448785, 0.11289724958212367, 0.09890002305471773, 0.10518520466235705, 0.062154233850562825, -0.06407386260731217, -0.1356711935184149, 0.1077582833943762, 0.11943560277592245, 0.1235183427240466, 0.12324445414627033, 0.12114608703164355, 0.12062940684703058, 0.11661701388523428, 0.1182226822926499, 0.11972531293546351, 0.12035666832545225, 0.12231137803110995, 0.12674529042552196, 0.12092441167067598, 0.11855589404966431, 0.11487597476309845, 0.12301020907468709, 0.11403063622870295, 0.11666212684922873, 0.1171927486988736, 0.12386121163447003, 0.12022596424689524, -0.14075194704344957, -0.13906271372605875, 0.0018563098620622792, 0.05188248191845892, 0.042955214736304856, -0.07945736411875157 ], [ 0.151891082810024, -0.11769387876743294, -0.12201590754761722, -0.12126139352472098, -0.11224262824088532, -0.11766234443128819, -7.217265979721203E-4, 2.976069512146718E-4, 3.09848755286912E-4, 5.869625772743453E-4, 0.0012881798133872497, -0.10196466921455755, -0.12376660206396477, -0.12029796064181653, -0.1144167903085211, -0.09899233852437961, -0.10686111234013168, -0.067367440392942, 0.06074872941999957, 0.1340116165546349, -0.10677635604206272, -0.12009011017211153, -0.12034786841440237, -0.12093937748258098, -0.12053080839195505, -0.12080682664703483, -0.11652574630281166, -0.11628719649804478, -0.12176199552126543, -0.12250715965988043, -0.11856173035505235, -0.11818202623736343, -0.12076344425989077, -0.11598883666791045, -0.11575039652590831, -0.11860923666967964, -0.11487792227506925, -0.11749910106671706, -0.1220027862134806, -0.12325038140829642, -0.12133535110080762, 0.13824366407039285, 0.13830155080140544, -0.00272508306066055, -0.054720647611703074, -0.04912598246966283, 0.06588804591869554 ], [ -0.13733506353660385, 0.12090962803823967, 0.11754956817782558, 0.1226647200936489, 0.10866232572413266, 0.11866985439952046, 0.0017830074212286805, -0.0021911097486456165, 0.0020402472900857937, 0.0029364975237151925, 6.927582375967278E-4, 0.09953044328894102, 0.12066764464329903, 0.12451663094679857, 0.1116787269373798, 0.09998517872945599, 0.11016432490028448, 0.0623787370982722, -0.06633528756582426, -0.13913883621194628, 0.10595145129853928, 0.11850016246383589, 0.12412644471560752, 0.12588753603500955, 0.12154329954078183, 0.11332463985167895, 0.1182235010396316, 0.11794438404476415, 0.12127555986696484, 0.12012582154038816, 0.11926244068844237, 0.12425077266145958, 0.11814552515793646, 0.1175601440865044, 0.11618328812583481, 0.1182111594397426, 0.11753994924788767, 0.11763991467449011, 0.1205217587005548, 0.12241700668335584, 0.12427049801158684, -0.14181109132259212, -0.13723522370221697, -0.003163137350341164, 0.049992977602892535, 0.04697784894267184, -0.08022776537666206 ], [ -0.12943128315356686, 0.11675154817820613, 0.11659056964581041, 0.11765445917791736, 0.09986996771520937, 0.11771736346247562, 0.001783896628866165, 0.0015156359134246636, -1.9203104315744174E-4, -7.278375975579086E-4, 0.001303818261333191, 0.09991858147764185, 0.12307577042012902, 0.12248200948857779, 0.10884745500480386, 0.10025922504094802, 0.10943456174550964, 0.06537270146817005, -0.05768097324667317, -0.13814421393208315, 0.10782358245099063, 0.11920257167437906, 0.11786815592013516, 0.12453031583629486, 0.11688344729124443, 0.11564366628237902, 0.11927611726826948, 0.11935019384555774, 0.12052870424848834, 0.11859808009718333, 0.11880263959443554, 0.12378789221212423, 0.11916587551564373, 0.11329263275453129, 0.11731537282584169, 0.11668599239740679, 0.1121357376507729, 0.11327564852468268, 0.12094559173970265, 0.12184550903481477, 0.12180642171167443, -0.13808033316005275, -0.13873566493432524, 0.003805146884541971, 0.04865668117154513, 0.04352777036803857, -0.0775995672538782 ], [ 0.15375846480650043, -0.11595582966218587, -0.12030075474988812, -0.11949181910431961, -0.10951785258589264, -0.11591840379834153, -0.0025466440001047, 0.0031158269966387485, 7.959501205678544E-4, -5.328547731600752E-4, -0.0026162091197509674, -0.09937559370524357, -0.11745672045159386, -0.11966797292416403, -0.11482197634962293, -0.10134353209284966, -0.10590576564476552, -0.0690847418994063, 0.05973151884103813, 0.13439482630748834, -0.10494534290497887, -0.11541419743562133, -0.11842300811405004, -0.11868791194528513, -0.11685084530127049, -0.1214925954241829, -0.11820396528706696, -0.11415430430894932, -0.12291822646639204, -0.11955209699729595, -0.12242440674575249, -0.12038189770250339, -0.12131430453300611, -0.11345805763963014, -0.11474245351930848, -0.11912597994589644, -0.11376068652649088, -0.11454148626540916, -0.12053830173736974, -0.12044623869571, -0.11807449956538077, 0.13415603249295463, 0.13453697812350884, -0.0013886955747061955, -0.0611830127897117, -0.05192787203116843, 0.06968957629359307 ], [ 0.15507119374575357, -0.11766035505603255, -0.11750626005742848, -0.11674862707502941, -0.11023511004150274, -0.12212846727782108, 0.0012840220482050466, -0.0015403898182914156, 6.174486650470998E-5, 0.005242161084164108, 0.0012006885809403198, -0.09740409899594034, -0.11819619607390966, -0.11809620457437893, -0.11170025217352264, -0.10366018914919238, -0.10932137682140858, -0.0646436735766389, 0.06022750428480135, 0.1396701650241278, -0.10797452306932048, -0.11785710092888511, -0.11784556647120617, -0.12660747687824275, -0.12153112457054785, -0.11824073497451208, -0.12127353900399274, -0.12161724995194435, -0.1233737749846659, -0.11973777512381237, -0.12372273324170752, -0.12390066658283067, -0.12572091546134573, -0.11327174404817444, -0.11763772284407063, -0.11445035512185864, -0.11725327012793593, -0.12139044938906869, -0.12345639391778196, -0.1287738847854028, -0.12231362274659713, 0.14191669141212057, 0.14073950760108778, -0.0012416931277432347, -0.04911499008037066, -0.04231401445423526, 0.08174461733888982 ], [ -0.13726883756468347, 0.11721064694417745, 0.1200799975258495, 0.11932517382424697, 0.10882498263278455, 0.12058741546984496, -0.0037886325106558823, -3.07628427056654E-4, -0.004356749915625766, -0.003661701853689388, -0.0014434016136961531, 0.1015396402894937, 0.1261685845947132, 0.12167656385908826, 0.11205483223828236, 0.09624408471832163, 0.1085976799586851, 0.06543910640505357, -0.06362219213721525, -0.140243818812719, 0.10670798611270438, 0.11964754104434408, 0.12220816251403697, 0.12357291168647948, 0.1238299643172656, 0.11744610934387929, 0.11753241165933472, 0.11902318100356095, 0.12111489467163972, 0.12107278895130387, 0.1243004646635493, 0.12055386349936628, 0.1226288031546074, 0.11483022833723844, 0.1211999341915737, 0.11259802601000166, 0.11650429728186164, 0.1166237682848489, 0.11844883277235693, 0.1248031289018018, 0.12122759424811674, -0.1385364320633732, -0.14383251010284306, -0.001497724801770274, 0.0454877820973947, 0.046630013928857524, -0.07700816428407756 ], [ -0.12653360447061227, 0.12159011911436388, 0.11903231605326733, 0.11887367172712426, 0.11105165554398883, 0.11927238257223063, 0.0038358527878526102, -2.7083902758303E-4, -9.251957395936381E-4, -0.0029644665212426964, 2.9030502515674575E-5, 0.09900763093657136, 0.12323915550462398, 0.1183348553524347, 0.11263481302406196, 0.0984937263729962, 0.10843680285233945, 0.06680378325774783, -0.059791146777535914, -0.1356753653082475, 0.11042023066202104, 0.11821296118986514, 0.11646168085869234, 0.11883580231011462, 0.11473988637733806, 0.1165151784809214, 0.11665836850960247, 0.11496372966251588, 0.11396825521789032, 0.11667662781070463, 0.12349059393582999, 0.1210797508052001, 0.12127513594978763, 0.1133504902133519, 0.11653888844422997, 0.11800310674407212, 0.11540048372578987, 0.11987784224918444, 0.1142570174164699, 0.12009826018399192, 0.12000295370661132, -0.13570237366862303, -0.1337360589188044, -6.632097709790098E-4, 0.0589048813641031, 0.05145680350693789, -0.06888146520535832 ], [ 0.15295619194199278, -0.11931296739860905, -0.12358632004784244, -0.11814229663107279, -0.10395824162466222, -0.11858544267860265, 6.275820368103391E-4, 5.129333144473785E-4, 0.0010457870970885267, -4.340244095992981E-4, 0.003226904548375858, -0.0990504958605736, -0.11925640512341319, -0.12244121162202466, -0.11086723637909432, -0.10256176382815066, -0.11219289329659103, -0.061226359709253754, 0.060925430097411935, 0.13967791384691589, -0.1061034235218424, -0.11677981626188615, -0.11865322535648726, -0.12320813179407977, -0.12065422820708165, -0.11634758811366118, -0.11625833863085475, -0.11859710378750048, -0.11826087926000883, -0.11756602897731933, -0.1193797526371005, -0.12254084967311096, -0.1247818420374048, -0.11203844098897149, -0.11616954206797636, -0.11697795984242307, -0.11680094221826874, -0.12408217528029121, -0.120206296310603, -0.12194935803027888, -0.12261842265859481, 0.14274673662528437, 0.14060543902285197, 6.934277015931769E-4, -0.0491484513553326, -0.046347514750626324, 0.07861840156548419 ] ], [ [ 0.009992605686077868, 0.1337637573247665, 0.13047403862866197, -0.1279002705444113, 0.13094737467356124, 0.12867068343829455, -0.12795401634825043, -0.13065182858372662, 0.1307241168068838, 0.12780883308584276, -0.1323758769809233 ] ] ]\n" +
        "}";

    StringReader reader = new StringReader(lambdaRankMod);
    Ranker lambdarank = RankerFactory.getFromModel("lambdarank", reader);
    Assert.assertTrue(lambdarank instanceof RankNetMLP);
  }

  @Test
  public void rankerFactoryGetSortNet() throws Exception {
    String sortNetMod = "{\n" +
        "  \"config\" : {\n" +
        "    \"algorithm\" : \"SortNet\",\n" +
        "    \"numIterations\" : 100,\n" +
        "    \"batchSize\" : 0,\n" +
        "    \"params\" : {\n" +
        "      \"learningRate\" : 0.01,\n" +
        "      \"optimizer\" : \"adam\",\n" +
        "      \"weightInit\" : \"xavier\",\n" +
        "      \"regularization\" : {\n" +
        "        \"regularizer\" : \"L2\",\n" +
        "        \"rate\" : 0.01\n" +
        "      },\n" +
        "      \"layers\" : [ {\n" +
        "        \"activator\" : \"Sigmoid\",\n" +
        "        \"num\" : 3\n" +
        "      } ]\n" +
        "    },\n" +
        "    \"dataSet\" : {\n" +
        "      \"training\" : \"data/MQ2008/Fold1/train.txt\",\n" +
        "      \"validation\" : \"data/MQ2008/Fold1/vali.txt\",\n" +
        "      \"test\" : \"data/MQ2008/Fold1/test.txt\"\n" +
        "    },\n" +
        "    \"model\" : {\n" +
        "      \"format\" : \"json\",\n" +
        "      \"file\" : \"model/sortnet-model.json\"\n" +
        "    },\n" +
        "    \"evaluation\" : {\n" +
        "      \"evaluator\" : \"NDCG\",\n" +
        "      \"params\" : {\n" +
        "        \"k\" : 10\n" +
        "      }\n" +
        "    },\n" +
        "    \"report\" : {\n" +
        "      \"format\" : \"csv\",\n" +
        "      \"file\" : \"report/sortnet-report.csv\"\n" +
        "    }\n" +
        "  },\n" +
        "  \"weights\" : [ [ [ -0.3036979508123979, 0.2107607315630929, 0.8776067312211893, 0.4111080944956443, 0.7240841150322737, 0.2835679472064474, 2.311866458209533E-18, -4.795068833318875E-19, 4.03874390843666E-18, -7.066465411292802E-18, 2.894954080475833E-18, -0.23729019250940755, 0.9819090739908902, 0.1944418455306649, 1.1489368566715072, -0.1942791554978015, -0.5551006769944689, 0.08509377574688648, 0.13393784730558148, -0.7977631651327896, -0.5497750077370772, -0.14185055312719247, -0.5753567846124955, -0.24126694688787778, -0.5349105690891897, 0.774086556842696, 0.33505444568495585, 0.6470487663215766, 0.6439500021920375, 0.21381966329982396, 0.07775610118966123, 0.09764540758593543, 0.22501359404081725, 1.236592480049357, 1.1330484886757304, 1.448247741335138, 0.8918159643479591, -0.10096292831381704, -0.4949243508452783, -0.15781159973992148, -0.38563005792934585, -0.5462480379898534, -0.8229145642369932, -5.813634250115885E-18, -0.4809762820847255, -0.4525688031373875, -0.7305320294013572 ], [ -0.2551815729498453, -0.5214084704101591, -0.11482206037877556, -0.0955448477425139, -0.4348333438256751, -0.48090834435802177, 4.646128833011907E-18, -8.135772288576763E-18, -2.3503594621362107E-18, -4.641255087118127E-18, -6.971476854236574E-19, 0.006385039878113973, -0.25530116124351926, -0.12169025678795038, -0.2522018301957044, -0.003065484881809659, -0.3342260039776704, -0.13776767583870628, 0.5537738554915913, 0.8676388670819823, -0.3325348935240849, -0.827799856698515, -0.7106278583416191, -1.9584252398358941, -0.7683551766832112, -0.022123550445442532, 0.09566289365666981, -0.19448542805103766, 0.14361273834411684, -0.038314058538928435, -0.1815488832641061, -0.47189476073705333, -0.3530067883340242, -0.37620118535783886, -0.1811771406229196, -0.03193346550810436, -0.07862421251760841, -0.7805292878340001, -0.8198382723084343, -1.830085918144809, -0.8464483444857662, 0.23662378658977076, 0.5360545520055162, -2.0618173985834446E-18, -0.40182849008829286, 0.007755845997857779, -0.13413914600615406 ], [ 0.8575905263950537, 0.7460247007761095, 0.15128306803449415, 0.47375288357851036, 0.02297205630724394, 0.754317553801665, -4.5013745446411524E-18, -4.667868150367147E-18, -8.13468305303885E-18, 5.2272736731926466E-18, -4.4700992059459285E-18, 0.7301248575404193, 0.2547567728129484, 0.558026203361016, 0.1157913119242649, 0.7249947857214128, 0.5957145081135186, 0.30464632541223396, 0.8764716190400315, 0.19620524193763203, 0.5943989994493334, 0.8987621485778199, 0.7469435675255941, 1.1820835645132481, 0.7061249354856771, 0.28540943127718327, 0.11570478158996884, 0.3226162547729853, 0.12052725559747743, 0.5921041806616779, 0.32750432665822277, 0.398867300865861, 0.45871751136166666, 0.11247670016267677, -0.0524477616706679, 0.05475838919163796, -0.04118639550930724, 0.8783331397450176, 0.6694190144733574, 1.1056837227077614, 0.7264639838384812, 0.3768344072177693, 0.07584896980975937, 4.151234989395863E-18, 0.48971188380091996, 0.32104037109478356, 0.38175051566074775 ], [ -0.3036979508123979, 0.7201919153701647, -0.058436298766392565, -0.26178771549458135, -0.6245253875495987, 0.7112022159814319, -2.4646834292370776E-18, -5.1897822609594625E-18, -7.451558469775368E-18, 1.2682777253993234E-19, -1.026493100800833E-18, 0.9100278279129711, -0.04475628558220962, -0.12850782715592865, -0.4078142818889349, 0.887740347987122, 0.8069398648169334, 0.08299196079109776, -0.9671527625487426, -0.34196192343125115, 0.8013098573112643, 0.6000393050854199, 1.7029303203755113, 1.6349274959569509, 1.890470901486391, -0.0970257477387597, 0.5846419500858755, 0.3314868726553179, 0.43070036522300487, 0.008935070887551012, 0.5168312697443659, 0.5142910596432616, 0.35474709290350465, -0.3433312631987832, 0.003445520874999762, -0.3183367175126598, -0.0675795041029332, 0.5262376238874962, 1.532583144580847, 1.5279141851736986, 1.7352166886692253, -0.5726195924096725, -0.08888791473024248, -3.913094176648669E-18, -0.2633817282665758, 0.3064850597408738, -0.4615935716026184 ], [ -0.2551815729498453, 0.14784169215654452, 1.4784109314992555E-4, 0.22315224207012632, 0.12225608612985328, 0.19379768913516884, -1.709354995598498E-18, 3.7631547019311046E-18, 1.0743051747833609E-17, -2.3937190030630747E-18, -1.7162377794208213E-18, 0.05166976475354549, 0.21705411557086005, 0.2241904647712468, -0.00891655131423145, 0.07868302920313847, -0.32688993545185985, -0.022052972654144742, -0.6177685714422234, -0.8175790821026648, -0.32775850044450294, 0.3854969552784061, 0.9040136870468741, 1.9504772119494447, 0.765786487983569, 0.3751480387714766, 0.0786530033597275, 0.506541232338575, 0.34248311715266655, 0.14816396210819754, 0.304827115014445, 0.4380787428342869, 0.38167579982867844, 0.012433280356252427, 0.23291721373536167, 0.04231101069749778, 0.14222448294460238, 0.3033400050317539, 0.9075820474183726, 1.8445681123290456, 0.8467128346070654, -0.2327588833671697, -0.48846561522516196, 4.420706939494211E-18, -0.3547994200252224, -0.1933791422500864, 0.017423989956692063 ], [ 0.8575905263950537, -0.0803588535365329, 0.1539910229603372, 0.12067673241989997, 0.18560809085582614, -0.07215329057042091, 3.38262068746337E-18, -1.855029027297036E-18, 1.5543427724241751E-18, -3.9064609701949604E-18, -6.228298499779486E-18, -0.13630285583828558, 0.12709488179792044, 0.006131659731159796, 0.1693562269652206, -0.12838332150632523, 0.14338004705315266, 1.028338579391516, 0.9993766140473632, 0.9729945934748312, 0.14731817199706895, 0.39265006174206535, 0.45385191603370195, 0.3179374751673891, 0.46316227251552966, 0.09353002979358155, -0.0433478044046359, -0.2495203796768287, 0.042677752880887765, 0.0639301258860578, -0.0437301210542909, -0.28013630936285594, -0.030728115991285693, 0.10408967037888378, 0.08605968667231297, 0.001696978058374783, 0.14791043246568233, 0.3620279240455544, 0.4545570359980429, 0.3813899549180589, 0.5145867601389831, 0.640200384476172, 0.9553734270434879, 2.032143231436479E-18, 0.3414493620628998, 0.6260557883964468, 0.7659846021485887 ] ], [ [ 0.0031966071436481764, -0.16679194857373017, -1.162478850879422, 0.699037985845447 ], [ 0.0031966071436481764, 0.16676898020272102, 1.160317709795436, -0.7010071583748181 ] ] ]\n" +
        "}";
    StringReader reader = new StringReader(sortNetMod);
    Ranker sortNet = RankerFactory.getFromModel("sortnet", reader);
    Assert.assertTrue(sortNet instanceof SortNetMLP);
  }

  @Test
  public void rankerFactoryGetListNet() throws Exception {
    String listNetMod = "{\n" +
        "  \"config\" : {\n" +
        "    \"algorithm\" : \"ListNet\",\n" +
        "    \"numIterations\" : 100,\n" +
        "    \"batchSize\" : 0,\n" +
        "    \"params\" : {\n" +
        "      \"learningRate\" : 0.001,\n" +
        "      \"optimizer\" : \"adam\",\n" +
        "      \"weightInit\" : \"xavier\",\n" +
        "      \"regularization\" : {\n" +
        "        \"regularizer\" : \"L2\",\n" +
        "        \"rate\" : 0.01\n" +
        "      },\n" +
        "      \"layers\" : [ {\n" +
        "        \"activator\" : \"Identity\",\n" +
        "        \"num\" : 10\n" +
        "      } ]\n" +
        "    },\n" +
        "    \"dataSet\" : {\n" +
        "      \"training\" : \"data/MQ2008/Fold1/train.txt\",\n" +
        "      \"validation\" : \"data/MQ2008/Fold1/vali.txt\",\n" +
        "      \"test\" : \"data/MQ2008/Fold1/test.txt\"\n" +
        "    },\n" +
        "    \"model\" : {\n" +
        "      \"format\" : \"json\",\n" +
        "      \"file\" : \"model/listnet-model.json\"\n" +
        "    },\n" +
        "    \"evaluation\" : {\n" +
        "      \"evaluator\" : \"NDCG\",\n" +
        "      \"params\" : {\n" +
        "        \"k\" : 10\n" +
        "      }\n" +
        "    },\n" +
        "    \"report\" : {\n" +
        "      \"format\" : \"csv\",\n" +
        "      \"file\" : \"report/listnet-report.csv\"\n" +
        "    }\n" +
        "  },\n" +
        "  \"weights\" : [ [ [ -35.48766526700717, 0.03530822088343961, -0.026243143081125953, -0.15227146202281647, 0.042731437915823, 0.11012698535241398, -5.006620958843479E-4, 3.776392531065185E-5, -2.0455091407880116E-4, -0.0026600963539944802, 1.6004957564820927E-4, -0.12617032473774129, -0.03336206289535311, 0.028552413228005006, 0.183302151980576, 0.026387634681846604, -0.04246124345713853, -0.03700539856619948, 0.13908985280110614, 0.17675404333596026, -0.0416167086163638, -0.09086811142301397, 0.02534221769459997, -0.5279633001539293, -0.07563032304110857, -0.08311279646254921, 0.13490521820528734, -0.08822404265443155, -0.11254953300378308, -0.06447009268600945, -0.015889096099149746, -0.08484766350535156, -0.07779112702670817, -0.25278019603116236, 0.10217108529663857, -0.08500853810452735, -0.03417555820211484, -0.0606432292415722, 0.16105245284289416, -0.418384595492447, -0.22639199707668278, 0.05214515644536179, -0.03449330111277129, 7.439452075010774E-4, 0.033758056560545896, -0.060559561647949775, 0.08565641161588768 ], [ 35.12670901762106, -0.05996173141810783, 0.015606117376300282, 0.1423548015436395, -0.04600196720890342, -0.13396867025943276, 0.0011875085685659663, -9.80112887307724E-4, 7.305197871205267E-4, 0.0010779840443267436, 2.5806362449850318E-5, 0.1049514031273587, 0.020592760580500434, -0.04099804274466444, -0.18237944157891894, -0.04678331579956866, 0.033802031064802604, 0.03369041351751248, -0.11562796315102683, -0.18240502492182029, 0.03094015288540698, 0.04768574628845558, -0.0725888032291678, 0.48085142634216327, 0.023123108942109245, 0.07889054612055944, -0.1439294426985204, 0.07598179307369299, 0.09912603366178951, 0.05016175772107973, 0.0072217294771165985, 0.07742982772859051, 0.06619106651656007, 0.2457694206120914, -0.11343036606277306, 0.07887532093464894, 0.024224313188516252, 0.02212263361147738, -0.20707730497395951, 0.3712776179478453, 0.1755550209252672, -0.04777242519385753, 0.025391198456128097, -7.833634756664299E-4, -0.019472164076817455, 0.06033106321769198, -0.07670589487943079 ], [ -33.34528703346982, 0.06320602957918518, -0.0017828619402542995, -0.06313872603194515, 0.014937021039248956, 0.13958898674390033, -3.4202695119928505E-5, 0.0010177662606335573, 0.0013787985442485782, -6.350970093391871E-4, -1.9264254593340745E-4, -0.10846658444574374, -0.013643360820521519, 0.10076048096744793, 0.15473273623245534, 0.0371161196638477, -0.05122511120293374, 0.016656231208267293, 0.09393224162519326, 0.10082330359020321, -0.04699909440797886, 0.020242369738044302, 0.15806390593674646, -0.33974329179591134, 0.05060819470481725, -0.08049631791663202, 0.13357530125841105, -0.05945590507935412, -0.09820125928453334, 0.019914261926470663, 0.08879999145303266, 0.03358640796344509, 0.014083158039449564, -0.2700175265673186, 0.09009664543264585, -0.10590652621303134, -0.02831078390796485, 0.039450863096269564, 0.2696438109570474, -0.24788613494644823, -0.10580823345543278, -0.027399399253179746, -0.061969761262686496, 0.0011822759321178094, 0.03700269385896711, -0.055135960883904836, -0.0013475225653341982 ], [ -34.39358928023594, 0.07167851094547166, -9.860772099170171E-5, -0.10794421953723898, 0.040752546043559386, 0.15042351491390638, 1.4063475801434804E-4, -9.039442530055476E-4, -0.001941433260200952, 0.0016537861604742593, 0.001325757012241865, -0.08695456475945952, -0.006999720054964788, 0.06999189686249375, 0.17177594597851423, 0.05988834450272668, -0.04356133141465312, -0.03094602110112753, 0.09446301366582933, 0.1766150760753213, -0.03933124824891293, 0.02188739208680061, 0.15644259835355837, -0.3977355445767982, 0.05634074628160694, -0.07658782785136724, 0.14451963660943537, -0.06783507530003309, -0.08721036889580139, -0.02356852181604996, 0.029029874608683087, -0.043161592586905814, -0.037476969767070774, -0.25754723662637574, 0.11911699009521483, -0.08709261609423073, -0.019598576508820836, 0.045220373049190465, 0.2843737550445634, -0.2941200694713541, -0.10156056893976223, 0.03622702366648285, -0.019612489549038326, -4.3895411460796415E-4, -0.0033539685520708818, -0.06037033663769314, 0.043067386778261586 ], [ 35.39554002097674, -0.04690395748539012, 0.022229368810608954, 0.1477173689634244, -0.043294276357224895, -0.11834693284052619, -0.0018094222825968994, 0.0014793794169390164, 5.238367991295799E-4, 8.397870404855577E-4, 0.0013102469741570863, 0.11842894425503253, 0.030126329275975573, -0.031944489420223224, -0.18209716481050578, -0.03315288145499927, 0.03921393841708952, 0.03532394656141138, -0.13150038996954955, -0.17987547134655085, 0.03761019077860905, 0.07367902972519505, -0.042169785996821404, 0.5126712846107477, 0.05627284646784778, 0.08393465189316877, -0.13764615528867113, 0.08160400778007477, 0.10693268257875481, 0.05903658758209254, 0.014529196141223688, 0.08415549755035208, 0.07283227296095167, 0.24885106904428264, -0.10557322420577837, 0.08201186175206736, 0.03023730402030175, 0.04633738643798122, -0.17792323358062342, 0.40328168621976407, 0.21118113133145297, -0.04952288532887037, 0.03096308141302645, 0.0023655256036938014, -0.02903108619322393, 0.05857156210545453, -0.08414472055605171 ], [ 35.55750484010328, -0.0348425795533666, 0.030260908942320267, 0.15202638089986975, -0.04106462094981584, -0.10370355683727617, 0.0012067576610682203, 0.0018105359523792673, 0.002166386261778222, -7.773740058777467E-4, 3.12916660319772E-4, 0.13063653565794905, 0.036789210628853534, -0.026335810050323663, -0.18275178694452993, -0.022199731817509557, 0.04632085533372921, 0.03808160243214372, -0.14117144207823526, -0.17591488704700928, 0.041865572753503104, 0.09594465542950971, -0.013431312261057945, 0.5360308006843135, 0.07999889458900064, 0.08466741915447758, -0.13589903587755764, 0.09074114167623067, 0.11507754181358923, 0.06718748204525106, 0.015209948631623109, 0.08662868253250634, 0.07640178534090955, 0.2528957173880591, -0.09833920429992812, 0.08258628233310576, 0.0361310425635384, 0.06666034818913315, -0.1525229741192068, 0.4277181852340568, 0.2377524170452132, -0.05309280151245979, 0.03511766394936967, -5.200923116070751E-4, -0.033900293563855696, 0.059573147465029466, -0.08992814421666312 ], [ -35.508417211889, 0.035694338653152934, -0.02996167519383317, -0.15567260827708793, 0.041642278857687905, 0.10515185512465353, 0.0012713599661056335, -8.729555789034738E-4, 0.0022395143585296744, 0.0012459054033931631, -7.763799848748103E-4, -0.13089326445644614, -0.03731704544057254, 0.027340093606281424, 0.18061382611216667, 0.01956072978334265, -0.04563384210004307, -0.03390504339958362, 0.14055603135493866, 0.17643012372837774, -0.040986030362658514, -0.09580189043507, 0.01714635299152643, -0.5319262225024509, -0.07920355660703157, -0.08283514186407262, 0.1373341814382809, -0.09077033269052313, -0.11314794888088688, -0.06680315625206538, -0.014570541230238317, -0.08704788437504822, -0.07955048827488904, -0.25269896480542464, 0.0995728972587753, -0.08050126339482162, -0.03624789180351917, -0.06698053488238394, 0.152987638892325, -0.42312150867626985, -0.23439225893306181, 0.05163098975250228, -0.0353952354118589, 0.0017047659733137677, 0.03575046090561903, -0.05815309809008641, 0.08444119697865583 ], [ 35.445570383456584, -0.040596017840369175, 0.027930308560417175, 0.15135314370249167, -0.04456607280182715, -0.11367536440963873, 5.769426719769231E-4, -5.420721292455626E-4, 1.9538887441098425E-4, 9.827631553773499E-4, 0.0012098970841381066, 0.12081673279678484, 0.03263789856471627, -0.0315737137508295, -0.18135569040284158, -0.028317895761714458, 0.04101304943800343, 0.03696278419662946, -0.1336780551182586, -0.17821984454509493, 0.03730941433462977, 0.08245403162723727, -0.03122012041050769, 0.5197479958544299, 0.06446363493494604, 0.08287021986699075, -0.1385089246125622, 0.08234444089735876, 0.11176238872965508, 0.05895709420390093, 0.014471954817189669, 0.08578699675468554, 0.07573619900891705, 0.25003693706709146, -0.10417444254586727, 0.08256141063041504, 0.032126068606106735, 0.054941547740488456, -0.1667834994389799, 0.412305292777149, 0.22200729565550878, -0.052016250077434295, 0.03292038518192107, -0.0027339533046860623, -0.0337431165780128, 0.061972491306839204, -0.08384508871674069 ], [ 35.443323642556095, -0.042960481314557056, 0.026758458217507143, 0.1502354036968634, -0.04319933071999487, -0.1135032818208777, 2.2308614440309197E-4, -3.120878117011203E-4, -8.647592035059293E-4, -0.0022984278365901704, -9.47142743732762E-4, 0.12306086527223645, 0.03171598479050395, -0.030638286060978213, -0.18658644728617776, -0.027316986880002447, 0.0397617555922536, 0.03380583680617283, -0.1335441541646394, -0.17915109859923006, 0.0353930896922764, 0.08370390167808378, -0.0349489206052562, 0.5202869192535701, 0.06410492961923739, 0.08086174037753531, -0.1376886625246112, 0.08585184447359065, 0.10940342194741015, 0.0640420089482849, 0.012595130295551352, 0.08599776731841924, 0.07540453591400112, 0.25098427312579796, -0.10317883940704485, 0.08231708096064357, 0.03428619346109717, 0.056825563370166025, -0.167418483429964, 0.4097336319857991, 0.21928736098236792, -0.05039408592718568, 0.030809960804868676, -6.423261233298919E-4, -0.03258854467608192, 0.06137333326516691, -0.08620554655156099 ], [ 29.369078541248467, -0.04589583733501887, 0.029384596253576367, 0.04454977811097878, -0.02572295659707611, -0.10823828186640541, -0.0011482595416345684, -7.734310851944344E-4, 0.0014105408848886596, 8.351305515254574E-4, -0.0011798628140404304, 0.11452632510597417, 0.052366260098023476, -0.07880445337790662, -0.15426954032382859, -0.012096240785829243, 0.08817362341271204, -0.04311305399828889, -0.081760300005526, -0.026405822924082428, 0.0828151392425914, -0.050678751361161956, -0.16627441927073075, 0.18396568296664603, -0.05820898148250174, 0.0772523449033779, -0.06897206519374036, 0.05208211494879617, 0.10701293560344072, 0.031458512126790274, -0.11145247248046053, -0.09578742864417696, -0.03420152415417438, 0.23370730573593904, -0.04042223626455579, 0.1287442192589436, 0.06132188990918535, -0.06143257763201495, -0.23872907141482919, 0.12858085429157923, 0.09286041703335972, -0.009732216331138082, 0.04442870495759693, 0.0015131047695566096, -0.04512888781804953, 0.04979102983567038, 0.062037412115565724 ] ], [ [ 35.37398178778539, -0.10162669912198961, 0.06804171699287218, -0.004438146770605158, -0.022453525940724552, 0.08923950792911482, 0.10741652402839236, -0.10591974586955089, 0.09583372337212152, 0.09574104476618166, -0.006504435514468925 ] ] ]\n" +
        "}";

    StringReader reader = new StringReader(listNetMod);
    Ranker listNet = RankerFactory.getFromModel("listnet", reader);
    Assert.assertTrue(listNet instanceof ListNetMLP);
  }

}